<!DOCTYPE html>
<html>
    <head>
        <title>Bet on the Queen</title>
        <script src="https://cdn.jsdelivr.net/npm/faunadb@latest/dist/faunadb.js"></script>
        <meta property="og:type" content="website">
        <meta property="og:title" content="GuypaBet">
        <meta property="og:description" content="Bet on the Queen's death NOW!!!!!!!!!!!!">
        <meta name="theme-color" content="#33aed6">
        <link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet">
    </head>
    <style>
body{
  font-family: 'Rubik';
}

@font-face {
  font-family: 'Rubik';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/rubik/v14/iJWZBXyIfDnIV5PNhY1KTN7Z-Yh-B4iFWkU1Z4Y.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}

    </style>
    <body onload="getBets()">
      <div style="text-align: center;">
<h1>When will the queen die?</h1>
<h2 id="title">Place your bets now and you could win £0!</h2>
<div style="background-color: #313131; border-radius: 20px; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19); width: 35%; margin: 0 auto; padding: 1.5rem;">
  <label style="color: #cccccc;"><i>Want to place a bet? Just fill out the form below.</i></label><br><br>
  <label style="font-size: 18px; color: white;">Username</label><br>
  <input id="username" type="text" placeholder="Enter a name..." style="border: none; font-family: 'Rubik'; height: 25px; border-radius: 7px; background-color: #292929; padding: 5px; color: white; width:60%"><br><br>
  <label style="font-size: 18px; color: white;">Amount (£)</label><br>
  <input id="money" type="number" placeholder="Enter an amount..." style="border: none; font-family: 'Rubik'; height: 25px; border-radius: 7px; background-color: #292929; padding: 5px; color: white; width:60%"><br><br>
  <label style="font-size: 18px; color: white;">Date</label><br>
  <input id="date" type="date" style="border: none; font-family: 'Rubik'; height: 25px; border-radius: 7px; background-color: #292929; padding: 5px; color: white; width:60%"><br><br>
  <label id="question" style="font-size: 18px; color: white;">(Anti-Spam) Type AAAAAA in the box below to verify.</label><br>
  <input id="response" placeholder="Enter a code..." type="text" style="border: none; font-family: 'Rubik'; height: 25px; border-radius: 7px; background-color: #292929; padding: 5px; color: white; width:60%"><br><br>
  <button onclick="placeBet()" style="border: none; border-radius: 5px; cursor: pointer; height: 40px; font-size: 15px; padding-left: 10px; padding-right: 10px; font-family: 'Rubik'; color: white; background-color: #18ab44;">Place Bet!</button>
  </div>
<label>Username</label>
<input id="username" style="margin-left: 10px; font-family: 'Rubik'" placeholder="Enter a name..." type="text"><br><br>
<label>Amount (£)</label>
<input id="money" style="margin-left: 10px; font-family: 'Rubik'" placeholder="Enter an amount..." type="number"><br><br>
<label>Date</label>
<input id="date" style="margin-left: 10px; font-family: 'Rubik'" placeholder="Enter a date..." type="date"><br><br>
<label id="question">(Anti-Spam) Type AAAAAA in the box to verify.</label>
<input id="response" style="margin-left: 10px; font-family: 'Rubik'" placeholder="Enter the code..." type="text"><br><br>
<button onclick="placeBet()" style="cursor: pointer; width: 200px; height: 25px; font-family: 'Rubik'">Place Bet!</button><br><br>
<h2 id="allbets">All Bets</h2>
<label style="max-height: 30px; overflow: auto;" id="bets"></label>
      </div>
<script>
    var faunadb = window.faunadb
  var q = faunadb.query
  var client = new faunadb.Client({
    secret: 'fnAEcG0iEaAAyB4b6yraRVIIsvt7lFIxvPDfiD6y',
    domain: 'db.eu.fauna.com',
    scheme: 'https',
  })
  let captcha = ""
    function placeBet(){
      if(document.getElementById("response").value != captcha)
      {
        alert("Anti-Spam question failed!")
      }
      else
      {
        if(document.getElementById("username").value == "" || document.getElementById("date").value == "" || document.getElementById("money").value == ""){
            alert("Please fill in all fields before placing a bet.")
        }
        else{
            if(parseInt(document.getElementById("money").value) > 10000 || parseInt(document.getElementById("money").value) < 0)
            {
              alert("Please bet a correct amount.")
            }
            else
            {
        client.query(
  q.Create(
    q.Collection('falconbet2'),
    { data: { name: document.getElementById("username").value, date:  document.getElementById("date").value, money:  document.getElementById("money").value } },
  )
)
.then(function (ret){

getBets()

})
        }}
      }    


    }

    function makeid(length) {
    var result           = '';
    var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    var charactersLength = characters.length;
    for ( var i = 0; i < length; i++ ) {
      result += characters.charAt(Math.floor(Math.random() * 
 charactersLength));
   }
   return result;
}


    function getBets(){
      captcha = makeid(6)
      document.getElementById("question").innerHTML = "(Anti-Spam) Type " + captcha + " to verify:"
        client.query(
   q.Map(
  q.Paginate(q.Documents(q.Collection('falconbet2'))),
  q.Lambda(x => q.Get(x))
)).then (function(x){ 
    let bets = ""
    var total = 0
    const test = x.data.reverse();
    for (let i = 0; i < 10; i++) {
      bets = bets + "&bull; <b>" + x.data[i].data.name + "</b> bets <b>£" + x.data[i].data.money + "</b> that the queen will die on <b>" + x.data[i].data.date.replace(/-/g, "/") + "</b><br>"

    }    
 
  for (var i = x.data.length - 1; i >= 0; i--) {
      total = total + parseInt(x.data[i].data.money)
  }
    document.getElementById("title").innerHTML = "Place your bets now and you could win £" + total + "!"
    document.getElementById("bets").innerHTML = bets  
    document.getElementById("allbets").innerHTML = "Recent Bets <i>[Total:" + x.data.length + "]</i>"  
    })
    }
</script>
    </body>
</html>
